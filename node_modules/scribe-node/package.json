{
  "name": "scribe-node",
  "description": "Scribe java OAuth library port to node.js",
  "author": {
    "name": "Marko Manninen",
    "email": "mmstud@gmail.com",
    "url": "http://about.me/markomanninen"
  },
  "version": "0.0.24",
  "homepage": "https://github.com/mmstud/scribe-node",
  "keywords": [
    "scribe",
    "oauth",
    "web2.0",
    "node.js",
    "coffeescript",
    "java",
    "google",
    "api",
    "facebook",
    "twitter",
    "linkedin"
  ],
  "licenses": [
    {
      "type": "MIT",
      "url": "https://raw.github.com/mmstud/scribe-node/master/LICENSE"
    }
  ],
  "repository": {
    "type": "git",
    "url": "https://github.com/mmstud/scribe-node.git"
  },
  "bugs": {
    "url": "https://github.com/mmstud/scribe-node/issues"
  },
  "main": "./lib/scribe.js",
  "dependencies": {},
  "devDependencies": {
    "xml2json": "0.2.3",
    "sprintf": "0.1.1",
    "coffee-script": ">=1.1.3"
  },
  "engines": {
    "node": ">= 0.4.7"
  },
  "readme": "# Scribe Java OAuth Library Port to Node.js\n\nThis library abstracts different OAuth schemes and modularizes web services so that both authorization routines and data retrieval after authorization is easy to do. Supported schemes are 1.0a and 2.0 so far, Echo definitely and maybe 1.0 to come later. For historical and credit note I need to state that library design is borrowed from the corresponding java library:\n\nhttps://github.com/fernandezpablo85/scribe-java\n\nDue to different language used (coffeescript + node.js) and pretty heavy alter of the design on some parts I rather did not \"github fork\" the original repository. Althought there are some OAuth libraries for node.js ([oauth](https://github.com/ciaranj/node-oauth) and [node-oauth](https://github.com/EastCloud/node-oauth) namely) reasoning behind this work was that I really liked the way scribe was organized, especially giving option to add easily different web2.0 services to the codebase as a widgets. I also wanted to offer more specific support to different web service APIs via widgets, not only general interface.\n\nFollowing small code snippets shows only general OAuth 1.0a and 2.0 dance routines. On final application storing tokens on each step differs a lot depending on how application is done. Normally store would be either some kind of persistent data store or session store. But on these examples I just hard code tokens inside functions before calling them. Its a lof of manual work I know, but on final application most of it is hidden behind the flow.\n\nFor more real implementation of the library you should follow `hubot-scripts` repository, analytics.coffee script specifically (coming soon).\n\n## Installation\n\nSource files are made with coffeescript as it provides seemingly cleaner and managable code. This adds one more step on development process thou. So if you want to add new widgets, fix bugs or add any new features, I recommend to install coffeescript first and use `cake build` on install directory to compile coffeescripts from `src` to `lib` directory. As an end user you would either get git repository or use `npm` to get scrible-node plus all depencities hassle free to your development environment:\n\n    npm install scribe-node\n\n## Widgets (APIs)\n\nOAuth widget is to fully demonstate OAuth process on application. One should carefully explore source from https://github.com/mmstud/scribe-node/blob/master/src/widgets/OAuth.coffee\n\nUsing widget would be as simple as:\n\n    scribe = require('scribe-node').load(['OAuth'])\n    services = {}\n    services['analytics'] = {'provider': scribe.GoogleApi, 'key': '{YOUR_KEY}', 'secret': '{YOUR_SECRET}', 'scope': 'https://www.google.com/analytics/feeds/', 'callback': 'oob'}\n    service = new scribe.OAuth({}, 'analytics', services)\n    service.get_authorization_url((url) -> console.log url)\n\n    # after getting code execute rest of the script\n    service.set_verification_code('{CODE}', (response) -> console.log response)\n    access_token = service.get_access_token()\n\n## OAuth 1.0a Dance Snippets\n\nNext steps are to demostrate retrieving authorization token in smaller pieces (if above method is not working for you for some reason) and use it on your application to access data from web service. Example uses OAuth 1.0a scheme. Later OAuth 2.0 examples will be added.\n\nNote that I'm using offpage application mode for authorization. It means callback page is set to `oob` which causes service provider to show  verification code on browser window. Then you need to paste code to your application manually. Approach is a little bit different on fully pledged web appliations, that can hide this part of the process behind the screen.\n\n### Get authorization url\n\n    get_authorization_url = (service) ->\n      request_token_extract = (response) ->\n        # request token should be saved somewhere because service.getAccessToken uses request token\n        # but here we just print it on console, where you can take tokens and save inside get_request_token function\n        request_token = service.api.getRequestTokenExtractor() response.data\n        console.log request_token\n        url = service.getAuthorizationUrl request_token\n        # as it is with request token, also url is printed to the console which you need to\n        # copy and paste to browser to retrieve the verification code\n        console.log \"\\nAuthorization url: \"+url\n\n      service.getRequestToken request_token_extract\n\n### Save verification code\n\nThis is the code you got from clicking and following the authorization url from the first step.\n\n    set_verification_code = (code) ->\n      # save code to data store or session store\n\n### Get verification code\n\n    get_verification_code = () ->\n      code = 'write_verification_code_here' # get from datastore or session\n      new scribe.Verifier code\n\n### Get request token at any point after get_authorization_url\n\n    get_request_token = () ->\n      token = 'write_request_token_here' # get from datastore or session\n      secret = 'write_request_secret_here' # get from datastore or session\n      new scribe.Token token, secret\n\n### Retrieve and save access token\n\n    set_access_token = (service) ->\n      access_token_extract = (response) ->\n        access_token = service.api.getAccessTokenExtractor() response.data\n        #save access token for later use\n        console.log access_token\n\n      service.getAccessToken get_request_token(), get_verification_code(), access_token_extract\n\n### Get access token at any point after set_access_token\n\nThis will return the final token you would use to retrieve data via selected web service. All earlier steps are just preparing and completing authorization for the service.\n\n    get_access_token = () ->\n      token = 'write_access_token_here' # get from datastore or session\n      secret = 'write_access_secret_here' # get from datastore or session\n      new scribe.Token token, secret\n\n## Google Analytics Example 1.0a\n\n### Authorize\n\nSo those are the helper functions to get final access token. Lets see how to use them and after that how to get Google nalytics account profiles using saved access token. As mentioned earlier, this is using OAuth 1.0a scheme. OAuth 2.0 is little bit different and will be explained later on using same Analytics example.\n\nFirst of all, you need to register Google application api key and secret to be able to finnish next steps. So if you dont have it yet, you can request them from: https://accounts.google.com/ManageDomains\n\nAfter that you can start coffee eval loop:\n\n    $ coffee\n\nThen evaluate `get_authorization_url` function and do the following:\n\n    scribe = require('scribe').load(['GoogleApi'])\n    service = new scribe.ServiceBuilder().provider(scribe.GoogleApi).apiKey('api_key').apiSecret('api_secret')._scope('https://www.google.com/analytics/feeds/').build()\n    get_authorization_url service\n\nCopy and paste printed url from console to browser and save code to `get_verification_code` function. Similarly save printed request tokens to `get_request_token` function and evaluate both of them on console. Evaluate also `set_access_token` function before doing the next:\n\n    set_access_token service\n\nNow save access tokens to `get_access_token` function and evaluate it on console again. Now we are done the dance!\n\n### Get profiles\n\nI will use xml2json parser here to transform xml formatted response from Google service to json, iterate over entries and print profile data on console. You may need to install xml2json before this (ctrl-c to quit coffee):\n\n    $ npm install xml2json\n    $ coffee\n\nAnd then from coffee eval loop:\n\n    scribe = require('scribe').load(['GoogleApi'])\n    parser = require('xml2json').toJson\n    \n    service = new scribe.ServiceBuilder()\n                  .provider(scribe.GoogleApi)\n                  .apiKey('api_key')\n                  .apiSecret('api_secret')\n                  ._scope('https://www.google.com/analytics/feeds/')\n                  .build()\n    access_token = get_access_token()\n    analytics_accounts_feed = 'https://www.google.com/analytics/feeds/accounts/default?max-results=5'\n    \n    handle_analytics_accounts_feed = (response) ->\n      console.log \"Listing Google Analytics account profiles:\\n\"\n      entries = JSON.parse(parser(response.data)).feed.entry\n      for entry in entries\n        console.log entry.id + \" \" + entry.title['$t'] + \" \" + entry[\"dxp:tableId\"]\n    \n    service.signedRequest(access_token, handle_analytics_accounts_feed, analytics_accounts_feed)\n\nIf you do a lot of interaction with Google Analytics or other Google services, you may want to create own model for more sophisticated approach, buts its beyond the scope of this work.\n\n### Supported and tested widget list\n\nThese are the specialized APIs that are already implemented on scribe-node library. Althought limited list of APIs mentiond here, it doesnt mean to you cannot use library with any other web service available from internet. Library should work with all OAuth 1.0a and 2.0 schemes. If you have made your own API, please dont hesitate to fork this repository, add API as a widget to the library and send a pull request.\n\n* FacebookApi\n* GoogleApi\n* GoogleApi2\n* LinkedInApi ([fernandezpablo85](http://github.com/fernandezpablo85))\n* OAuth\n* TwitterApi ([fernandezpablo85](http://github.com/fernandezpablo85))\n\n### Yet to be done list\n\n* YammerApi\n* YahooApi\n* VkontakteApi\n* VimeoApi\n* SohuWeiboApi\n* SinaWeiboApi\n* SimpleGeoApi\n* SapoApi\n* QWeiboApi\n* PlurkApi\n* NeteaseWeibooApi\n* LoveFilmApi\n* LiveApi\n* KaixinApi\n* FoursquareApi\n* Foursquare2Api\n* EvernoteApi\n* DropBoxApi\n* ConstantContactApi\n\n## TODO\n\n* extracting tokens might be over generalizing now when they are on classes having only extract method. simpler way would be to use just functions, but need to research, if there is any name collision possibility. but i think not because they would be inside module anyway\n* all the apis to widgets from original java lib. see supported list\n* separate OAuth 1.0a and 2.0 examples\n* hubot script for full demostration of Google Analytics graphical chart generation",
  "readmeFilename": "README.md",
  "_id": "scribe-node@0.0.24",
  "_from": "scribe-node@>=0.0.24"
}
